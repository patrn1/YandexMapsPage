<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"> 
    <title>Карты</title>
    <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
</head>
<body>
    <div id="map" style="width: 600px; height: 400px"></div>
    <script type="text/javascript">
        var placemark = null;
        var addPlacemark = function(coords) {
            placemark ? myMap.geoObjects.remove(placemark) : null;
            placemark = new ymaps.Placemark(coords);
            // placemark.name = "Екатеринбург";
            // placemark.description = "Столица Урала";
            placemark.events.add('dblclick', function(evt) {
                evt.preventDefault();
                myMap.geoObjects.remove(placemark);
            });
            placemark.events.add('dragstart', function(evt) {
                // evt.preventDefault();
                // myMap.geoObjects.remove(placemark);
                // var coords = evt.get('coords');
                // var placemark = new ymaps.Placemark(coords);
                // myMap.geoObjects.add(placemark);Field
                console.log('dragstart');
            });
            placemark.events.add('dragstart', function(evt) {
                console.log('drag');
            });
            placemark.events.add('dragend', function(evt) {
                console.log('dragend');
            });    
            myMap.geoObjects.add(placemark);
        };
        ymaps.ready(init);
        var myMap;
        function init(){     
            myMap = new ymaps.Map("map", {
                center: [56.50, 60.30],
                zoom: 7,
                controls: []
            });
            
            myMap.events.add('click', function(evt) {
                var coords = evt.get('coords');
                addPlacemark(coords);
            });
        }
    </script>
    <input type="text" class="address-field"></input>
    <input type="submit" class="submit-btn"></input>
    <script>
        var submitBtn = document.querySelector(".submit-btn");
        var addressField = document.querySelector(".address-field");
        submitBtn.addEventListener('click', function() {
            var xhr = new XMLHttpRequest();
            const path = 'https://geocode-maps.yandex.ru/1.x/?format=json&geocode=';
            xhr.open('GET', path + addressField.value);
            xhr.send();
            xhr.onreadystatechange = function() {
                if (xhr.status === 200) {
                    if (xhr.readyState !== 4) {
                        return;
                    }
                    var response = JSON.parse(xhr.responseText).response;
                    var coords = response.GeoObjectCollection.featureMember[0].GeoObject.Point.pos.split(" ");
                    addPlacemark([parseInt(coords[1]), parseInt(coords[0])]);
                    myMap.panTo([parseInt(coords[1]), parseInt(coords[0])]);
                }
            };
        });
    </script>
</body>
</html>
